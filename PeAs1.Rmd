---
title: 'Repdata-033: Peer Assessment 1'
author: "AAGP80"
date: "12 ottobre 2015"
output: html_document
---


## Requirements
The following R packages are needed:

```{r req, message=FALSE}
require(lubridate)
require(dplyr)
require(ggplot2)
require(xtable)
options(scipen = 1)
```


## Loading and preprocessing the data
It is supposed that activity.csv is in the same folder of this Rmd file.
Data from activity.csv are loaded and dates are properly converted.

```{r load}
activity<-read.csv("activity.csv",stringsAsFactors = FALSE)
activity$date<-ymd(activity$date)
```


## What is mean total number of steps taken per day?
In order to answer to this question, activity has been grouped by date and it was calculated the total number of steps taken per day ignoring NA values.

```{r distribdata}
activity_by_date<-group_by(activity,date)
tot_steps_by_date<-summarise(activity_by_date,number=sum(steps,na.rm=TRUE))
```

The following figure shows the distribution of the total number of steps taken each day

```{r distribplot, fig.width=5, fig.height=5, message=FALSE }
ggplot(tot_steps_by_date, aes(x=number))+
        geom_histogram()+
        labs(title="Distribution of total number of steps",
             x="Total number of steps",
             y="Number of occurrence")+
        theme_bw()
```

The following table summarize the mean and the median (rounded) of the previous distribution.

Stat. Quantity  | Value
 ------------- | -------------
 Mean          | `r round(mean(tot_steps_by_date$number),1)` 
 Median        | `r round(median(tot_steps_by_date$number),1)`


## What is the average daily activity pattern?
In order to answer to this question activity has been grouped by interval and it was calculated the mean ignoring NA values.

```{r patterndata}
activity_by_int<-group_by(activity,interval)
avg_steps_by_int<-summarise(activity_by_int,avg=mean(steps,na.rm=TRUE))
```

The following figure shows the average number of steps taken averaged across all days. The five minute acquisition intervals are to be read in the following way:

* 0 = 00:00
* 1000 = 10:00
* 20000 = 20:00

```{r patternplot, fig.width=5, fig.height=5, message=FALSE }
ggplot(avg_steps_by_int, aes(interval,avg))+
        geom_line()+
        labs(title="Number of steps daily pattern",
             x="Interval",
             y="Average of total number of steps")+
        theme_bw()
```

Interval `r as.numeric(avg_steps_by_int[which.max(avg_steps_by_int$avg),1])` (i.e. 08:35) contains the maximum number of steps.


## Imputing missing values

```{r missingdata}
tot_NA_by_date<-summarise(activity_by_date,NAnumber=sum(is.na(steps)))
```

the following table shows that entire days are missing

```{r missingtable, results='asis'}
xt<-filter(tot_NA_by_date,NAnumber!=0)
xt$date<-as.character(xt$date)
xt<-xtable(xt)
print(xt, type="html",include.rownames=FALSE)
```

The total number of NA values in the dataset is `r sum(tot_NA_by_date$NAnumber)`.

Since the presence of NA values may introduce bias into some calculations, ............